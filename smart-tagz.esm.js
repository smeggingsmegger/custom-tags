import{defineComponent as e,openBlock as n,createElementBlock as t,pushScopeId as a,popScopeId as l,createElementVNode as u,ref as o,toRef as r,computed as i,nextTick as c,resolveComponent as d,normalizeClass as s,normalizeStyle as f,withDirectives as p,withKeys as v,vModelText as g,toDisplayString as h,createVNode as y,createCommentVNode as m,watch as S,TransitionGroup as b,withCtx as w,Fragment as x,renderList as C,createBlock as E,renderSlot as k,defineEmits as T,unref as D,withModifiers as _}from"vue";var I=e({name:"CloseIcon"}),O={class:"icon-wrapper"},R={id:"Capa_1",version:"1.1",x:"0px",y:"0px",viewBox:"0 0 512.001 512.001",style:{"enable-background":"new 0 0 512.001 512.001"},"xml:space":"preserve"},A=[function(e){return a("data-v-1a43cbde"),e=e(),l(),e}((function(){return u("g",null,[u("g",null,[u("path",{d:"M284.286,256.002L506.143,34.144c7.811-7.811,7.811-20.475,0-28.285c-7.811-7.81-20.475-7.811-28.285,0L256,227.717\n        L34.143,5.859c-7.811-7.811-20.475-7.811-28.285,0c-7.81,7.811-7.811,20.475,0,28.285l221.857,221.857L5.858,477.859\n        c-7.811,7.811-7.811,20.475,0,28.285c3.905,3.905,9.024,5.857,14.143,5.857c5.119,0,10.237-1.952,14.143-5.857L256,284.287\n        l221.857,221.857c3.905,3.905,9.024,5.857,14.143,5.857s10.237-1.952,14.143-5.857c7.811-7.811,7.811-20.475,0-28.285\n        L284.286,256.002z"})])],-1)}))];I.render=function(e,a,l,u,o,r){return n(),t("div",O,[(n(),t("svg",R,A))])},I.__scopeId="data-v-1a43cbde",I.__file="src/components/CloseIcon.vue";var B=e({name:"SmartTag",components:{CloseIcon:I},props:{name:{type:String,default:""},onRemove:{type:Function,required:!0},onEdit:{type:Function,required:!0},editable:{type:Boolean,default:!1},id:{type:String,default:null},highlight:Boolean,readOnly:{type:Boolean,default:!1},tagStyle:{type:Object,default:function(){return{foreColor:"",backgroundColor:""}}}},setup:function(e){var n=o(!1),t=o(e.name),a=o(),l=r(e,"highlight"),u=i((function(){return e.editable&&n.value&&!e.readOnly})),d=i((function(){return!e.readOnly})),s=i((function(){return{background:l.value?"#b20000":e.tagStyle.backgroundColor,color:e.tagStyle.foreColor}}));return{handleRemove:function(n){return e.onRemove(n)},handleDoubleClick:function(){e.editable&&!e.readOnly&&(n.value=!n.value,c((function(){a.value.focus()})))},handleSaveEdit:function(){n.value=!1,e.onEdit(e.id,t.value)},handleEscape:function(){n.value=!1},editMode:n,input:t,inputTextRef:a,canShowInputbox:u,canShowRemoveBtn:d,style:s}}});B.render=function(e,a,l,u,o,r){var i=d("CloseIcon");return n(),t("div",{class:s(["tag-container",{"no-remove":!e.canShowRemoveBtn}]),style:f(e.style)},[e.canShowInputbox?p((n(),t("input",{key:0,ref:"inputTextRef","onUpdate:modelValue":a[0]||(a[0]=function(n){return e.input=n}),type:"text",class:"tag-edit-input",onBlur:a[1]||(a[1]=function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return e.handleEscape&&e.handleEscape.apply(e,n)}),onKeyup:[a[2]||(a[2]=v((function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return e.handleSaveEdit&&e.handleSaveEdit.apply(e,n)}),["enter"])),a[3]||(a[3]=v((function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return e.handleEscape&&e.handleEscape.apply(e,n)}),["esc"]))]},null,544)),[[g,e.input]]):(n(),t("span",{key:1,class:"tag-name",onDblclick:a[4]||(a[4]=function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return e.handleDoubleClick&&e.handleDoubleClick.apply(e,n)})},h(e.name),33)),e.canShowRemoveBtn?(n(),t("button",{key:2,onClick:a[5]||(a[5]=function(n){return e.handleRemove(e.id)})},[y(i)])):m("v-if",!0)],6)},B.__scopeId="data-v-bb7ceecc",B.__file="src/components/Tag.vue";var P=e({name:"SmartTags",components:{SmartTag:B},props:{readOnly:{type:Boolean,default:!1},tags:{type:Array,required:!0},onRemove:{type:Function,required:!0},onEdit:{type:Function,required:!0},editable:{type:Boolean,default:!1},tagStyle:{type:Object,default:function(){return{}}}},setup:function(e){var n=e.readOnly?e.tags.map((function(e){return Object.assign({},e,{editable:!1})})):e.tags,t=o(n);return S((function(){return e.tags}),(function(e){t.value=e})),{localTags:t,handleRemove:function(n){return e.onRemove(n)},handleEdit:function(n,t){return e.onEdit(n,t)}}}}),M={class:"tags-container"};P.render=function(e,a,l,u,o,r){var i=d("SmartTag");return n(),t("div",M,[y(b,{name:"tags-list"},{default:w((function(){return[(n(!0),t(x,null,C(e.localTags,(function(t){return n(),E(i,{id:t.id,key:t.id,highlight:t.highlight,name:t.name,value:t.value,"on-remove":e.handleRemove,"on-edit":e.handleEdit,editable:e.editable,"read-only":e.readOnly,"tag-style":e.tagStyle},null,8,["id","highlight","name","value","on-remove","on-edit","editable","read-only","tag-style"])})),128))]})),_:1}),k(e.$slots,"default")])},P.__scopeId="data-v-acc9a86e",P.__file="src/components/Tags.vue";var K=e({name:"SuggestPane",props:{items:{type:Array,default:function(){return[]},required:!0},show:{type:Boolean,default:!1},onSelection:{type:Function},onPaneEsc:{type:Function},keyword:{type:String,required:!0},paneStyle:{type:Object,default:function(){return{bgColor:""}}},selectedIndex:{type:Number,default:-1}},setup:function(e){var n=o(!1),t=function(n){return e.onSelection&&e.onSelection(n)},a=o(null);return S((function(){return e.show}),(function(e){n.value=!!e})),{handleSelection:t,showPane:n,paneRef:a,handleEnter:function(n){n.preventDefault(),n.stopImmediatePropagation();var a=e.items[e.selectedIndex];t(a)}}}}),j={key:0,class:"suggest-pane-container"},q=["onMousedown"];function F(e){if("string"!=typeof e)throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}K.render=function(e,a,l,o,r,i){return e.showPane?(n(),t("div",j,[u("ul",{ref:"paneRef",class:"suggest-pane",style:f({background:e.paneStyle.bgColor}),tabindex:"0"},[(n(!0),t(x,null,C(e.items,(function(a,l){return n(),t("li",{key:a,class:s(["suggest-pane-item",{selected:l===e.selectedIndex}]),onMousedown:function(n){return e.handleSelection(a)}},[u("span",null,h(a),1)],42,q)})),128))],4)])):m("v-if",!0)},K.__scopeId="data-v-f2c085e8",K.__file="src/components/SuggestPane.vue";function L(e){for(var n=void 0,t=e[0],a=1;a<e.length;){var l=e[a],u=e[a+1];if(a+=2,("optionalAccess"===l||"optionalCall"===l)&&null==t)return;"access"===l||"optionalAccess"===l?(n=t,t=u(t)):"call"!==l&&"optionalCall"!==l||(t=u((function(){for(var e=[],a=arguments.length;a--;)e[a]=arguments[a];return t.call.apply(t,[n].concat(e))})),n=void 0)}return t}var U=e({name:"SmartTagz",components:{SmartTags:P,SuggestionPane:K},props:{readOnly:{type:Boolean,default:!1},defaultTags:{type:Array,default:function(){return[]}},width:{type:String,default:"100%"},sources:{type:Array,default:function(){return[]}},autosuggest:{type:Boolean,default:!1},allowPaste:{type:Object,default:null},editable:{type:Boolean,default:!1},allowDuplicates:{type:Boolean,default:!0},maxTags:{type:Number,default:20},inputPlaceholder:{type:String,default:"Enter tag..."},quickDelete:{type:Boolean,default:!1},onChanged:{type:Function,default:null},theme:{type:Object,default:function(){return{primary:"#6093ca",background:"#eaf1f8",tagTextColor:"#fff"}}}},setup:function(e){var n=e.autosuggest,t=e.allowPaste;void 0===t&&(t={delimiter:","});var a=e.allowDuplicates,l=e.maxTags,u=e.defaultTags;void 0===u&&(u=[]);var r=e.sources,d=e.quickDelete,s=e.width,f=e.onChanged,p=o(null),v=o(u.slice(0,l).map((function(e){return{id:Math.random().toString(16).slice(2),name:e,value:e}}))),g=o(),h=o(""),y=o(u.length?Math.min(u.length,l):0),m=o(!1),b=o(!1),w=o(-1),x=i((function(){return{width:s}})),C=i((function(){var e=new RegExp("^"+F(h.value),"i");return r.filter((function(n){return e.test(n)}))})),E=T(["changed"]),k=function(){c((function(){L([g,"access",function(e){return e.value},"optionalAccess",function(e){return e.focus},"call",function(e){return e()}])}))};S((function(){return v.value.length}),(function(){L([f,"optionalCall",function(e){return e(v.value.map((function(e){return e.value})))}]),E("changed")})),S(h,(function(e){p.value&&(p.value=null,v.value=v.value.map((function(e){return delete e.highlight,e}))),e?(b.value=!1,n&&e.length>0?m.value=!0:n&&e.length<1&&(m.value=!1)):m.value=!1})),S(b,(function(e){v.value=v.value.map((function(n){return Object.assign({},n,{highlight:e})}))}));var _=function(e){var n="",t=D(w);if(function(e){var n=new RegExp("^"+F(e)+"$","ig"),t=a||!v.value.some((function(t){return t.name===e||n.test(t.name)})),u=y.value<l;return t&&u}(n=t>-1?C.value[t]:e)){var u=null;(u=m.value&&w.value>-1?C.value[w.value]:n)&&(v.value=v.value.concat({name:u,id:Math.random().toString(16).slice(2),value:u})),h.value="",m.value=!1,y.value=+y.value+1,w.value=-1,k()}};return{tagsData:v,input:h,style:x,textInput:g,emit:E,showSuggestions:m,selectedIndex:w,filteredItems:C,handleKeyUp:function(e){e.preventDefault();var n=D(w);w.value=n>0?w.value-1:D(C).length-1},handleKeydown:function(e){e.preventDefault(),D(w)<D(C).length-1?w.value=+w.value+1:w.value=0},handleAddTag:_,handleRemoveTag:function(e){v.value=v.value.filter((function(n){return n.id!==e})),y.value=+y.value-1},handleDelete:function(){if(!h.value){if(b.value)return v.value=[],b.value=!1,void(y.value=0);if(p.value){var e=p.value;v.value=v.value.filter((function(n){return n.id!==e.id})),p.value=null,y.value=+y.value-1}else if(v.value.length){var n=v.value[v.value.length-1];p.value={id:n.id},v.value=v.value.map((function(e){return e.id===n.id?Object.assign({},e,{highlight:!0}):e}))}}},handleEscape:function(){return v.value=v.value.map((function(e){return delete e.highlight,e})),m.value=!1,b.value=!1,void(w.value=-1)},handlePaste:function(e){e.stopPropagation(),e.preventDefault();var n=L([e,"access",function(e){return e.clipboardData},"optionalAccess",function(e){return e.getData},"call",function(e){return e("text")}]);if(n){var u=function(e,n,t,a,l,u){if(n){var o=t-a,r=l?n.split(l):[];if(!(r.length>1))return{newData:e.concat({name:n,value:n,id:Math.random().toString(16).slice(2)}),tagsCreated:a+1};if(r=r.slice(0,Math.min(r.length,o)),!u){var i=e.map((function(e){return e.name})),c=r.filter((function(e){return!1===i.includes(e)}));r=[].concat(new Set(c))}if(r.length)return{newData:e.concat(r.map((function(e){return{name:e,value:e,id:Math.random().toString(16).slice(2)}}))),tagsCreated:a+r.length}}}(D(v),n,l,+D(y),L([t,"optionalAccess",function(e){return e.delimiter}]),a);L([u,"optionalAccess",function(e){return e.newData}])&&(v.value=u.newData,y.value=u.tagsCreated)}},handleEditTag:function(e,n){v.value=v.value.map((function(t){return t.id===e?Object.assign({},t,{name:n,value:n}):t})),L([f,"optionalCall",function(e){return e(v.value.map((function(e){return e.value})))}]),E("changed")},handleSuggestSelection:function(e){m.value=!1,c((function(){_(e)}))},handleSuggestEsc:function(){k(),m.value=!1},handleSelectAll:function(e){d&&(65!==e.keyCode||h.value||(b.value=!0,p.value=null))}}}}),$={key:0,class:"input-wrapper"},z=["placeholder"];U.render=function(e,a,l,o,r,i){var c=d("SuggestionPane"),h=d("SmartTags");return n(),t("div",{class:"tags-main",style:f({background:e.theme.background}),onKeyup:a[9]||(a[9]=_((function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return e.handleSelectAll&&e.handleSelectAll.apply(e,n)}),["ctrl"]))},[y(h,{tags:e.tagsData,"on-remove":e.handleRemoveTag,"on-edit":e.handleEditTag,editable:e.editable,"read-only":e.readOnly,"tag-style":{foreColor:e.theme.tagTextColor,backgroundColor:e.theme.primary}},{default:w((function(){return[e.tagsData.length<e.maxTags?(n(),t("div",$,[e.readOnly?m("v-if",!0):p((n(),t("input",{key:0,ref:"textInput","onUpdate:modelValue":a[0]||(a[0]=function(n){return e.input=n}),type:"text",placeholder:e.inputPlaceholder,onKeyup:[a[1]||(a[1]=v((function(n){return e.handleAddTag(n.target.value.trim())}),["enter"])),a[2]||(a[2]=v((function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return e.handleDelete&&e.handleDelete.apply(e,n)}),["delete"])),a[3]||(a[3]=v((function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return e.handleEscape&&e.handleEscape.apply(e,n)}),["esc"]))],onKeydown:[a[4]||(a[4]=v((function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return e.handleKeydown&&e.handleKeydown.apply(e,n)}),["down"])),a[5]||(a[5]=v((function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return e.handleKeyUp&&e.handleKeyUp.apply(e,n)}),["up"])),a[6]||(a[6]=_((function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return e.handleSelectAll&&e.handleSelectAll.apply(e,n)}),["ctrl","exact"]))],onPaste:a[7]||(a[7]=function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return e.handlePaste&&e.handlePaste.apply(e,n)}),onBlur:a[8]||(a[8]=function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return e.handleEscape&&e.handleEscape.apply(e,n)})},null,40,z)),[[g,e.input]]),u("div",{class:s(["suggestion-wrapper",{hidden:!e.showSuggestions}])},[y(c,{show:e.showSuggestions,items:e.filteredItems,keyword:e.input,"on-selection":e.handleSuggestSelection,"on-pane-esc":e.handleSuggestEsc,"pane-style":{bgColor:e.theme.primary},"selected-index":e.selectedIndex,focus:!1},null,8,["show","items","keyword","on-selection","on-pane-esc","pane-style","selected-index"])],2)])):m("v-if",!0)]})),_:1},8,["tags","on-remove","on-edit","editable","read-only","tag-style"])],36)},U.__scopeId="data-v-54d3a52e",U.__file="src/components/Main.vue";export{U as SmartTagz};
